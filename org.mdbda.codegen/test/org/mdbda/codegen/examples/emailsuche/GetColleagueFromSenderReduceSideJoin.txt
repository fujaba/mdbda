{
	"mapFunction":[{
		"testInput":[
"\"Road.Runner@acme.com\";\"Wile.E.Coyote@acme.com\"",
"\"Road.Runner@acme.com\";\"Foghorn.Leghorn@acme.com\"",
"\"Road.Runner@acme.com\";\"Elmer.Fudd@acme.com\"",
"\"Foghorn.Leghorn@acme.com\";\"Road.Runner@acme.com\"",
"\"Wile.E.Coyote@acme.com\";\"Road.Runner@acme.com\"" ],

		"testOutput":[
"\"Road.Runner@acme.com\";\"0:Wile.E.Coyote@acme.com\"",
"\"Road.Runner@acme.com\";\"0:Foghorn.Leghorn@acme.com\"",
"\"Road.Runner@acme.com\";\"0:Elmer.Fudd@acme.com\"",
"\"Wile.E.Coyote@acme.com\";\"0:Road.Runner@acme.com\"",
"\"Foghorn.Leghorn@acme.com\";\"0:Road.Runner@acme.com\""
 ],
		"KEYIN":"Text",
		"VALUEIN":"Text",
		"KEYOUT":"Text",
		"VALUEOUT":"Text", 
		"function":"
	context.write(key, new Text(\"0:\" + value));
		"
	},{
		"testInput":[
"\"Road.Runner@acme.com:mh@hahnpro.com:ts1\";null",
"\"Foghorn.Leghorn@acme.com:mh@hahnpro.com:ts2\";null",
"\"Elmer.Fudd@acme.com:info@hahnpro.com:ts3\";null" 
],

		"testOutput":[ 
"\"Road.Runner@acme.com\";\"1:mh@hahnpro.com:ts1\"",
"\"Foghorn.Leghorn@acme.com\";\"1:mh@hahnpro.com:ts2\"",
"\"Elmer.Fudd@acme.com\";\"1:info@hahnpro.com:ts3\""
],
		"KEYIN":"Text",
		"VALUEIN":"NullWritable",
		"KEYOUT":"Text",
		"VALUEOUT":"Text", 
		"function":"
	String[] splitKey = key.toString().split(\":\");
	context.write(new Text(splitKey[0]), new Text(\"1:\" + splitKey[1] + \":\" + splitKey[2]));
		"
	}],
	"reduceFunction":{		
		"testInput":[
"\"Road.Runner@acme.com\";[
	\"0:Wile.E.Coyote@acme.com\",
	\"0:Foghorn.Leghorn@acme.com\",
	\"0:Elmer.Fudd@acme.com\",
	\"1:mh@hahnpro.com:ts1\" ] ",
"\"Wile.E.Coyote@acme.com\";[
	\"0:Road.Runner@acme.com\",
	\"1:mh@hahnpro.com:ts2\" ]",
	
"\"Foghorn.Leghorn@acme.com\";[
	\"0:Road.Runner@acme.com\",
	\"1:info@hahnpro.com:ts3\" ]"
],
		"testOutput":[
"\"Road.Runner@acme.com\";\"Wile.E.Coyote@acme.com:mh@hahnpro.com:ts1\"",
"\"Road.Runner@acme.com\";\"Foghorn.Leghorn@acme.com:mh@hahnpro.com:ts1\"",
"\"Road.Runner@acme.com\";\"Elmer.Fudd@acme.com:mh@hahnpro.com:ts1\"",
"\"Wile.E.Coyote@acme.com\";\"Road.Runner@acme.com:mh@hahnpro.com:ts2\"",
"\"Foghorn.Leghorn@acme.com\";\"Road.Runner@acme.com:info@hahnpro.com:ts3\""
 ],
		"KEYIN":"Text",
		"VALUEIN":"Text",
		"KEYOUT":"Text",
		"VALUEOUT":"Text", 
		"function":"
	input0.clear();
	input1.clear();
			
	while(values.iterator().hasNext()){
		Text val = values.iterator().next();
		switch (val.charAt(0)) {
		case '0':
			input0.add(new Text(val.toString().substring(2)));
			break;
		case '1':
			input1.add(new Text(val.toString().substring(2)));
			break;
		default:
			break;
		}
	}
			
	for(Text el0 : input0){
		for(Text el1 : input1){
			context.write(key, new Text(el0 + \":\" + el1));
		}
	}
		",
		
		"fields":"
	java.util.ArrayList<Text> input0 = new java.util.ArrayList<>();
	java.util.ArrayList<Text> input1= new java.util.ArrayList<>();
		"
	},
	
	"jobConfig":"
		//default conf
	"
}